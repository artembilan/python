# spring-cloud-stream-app-starters-python
:java-python-buildpack:  https://github.com/dturanski/java-python-buildpack
:python-buildpack: https://github.com/cloudfoundry/python-buildpack
:java-buildpack: https://github.com/cloudfoundry/python-buildpack

Spring Cloud Stream App Starters for integrating with Python

# Accessing Python Resources

These applications include configuration properties that specify Python script locations and directories. These
properties use Spring's
http://docs.spring.io/spring/docs/current/spring-framework-reference/html/resources.html[Resource] abstraction.

Python scripts may point to a local file  or  URL resources such as
https://raw.githubusercontent.com/dturanski/python-apps/master/test-wrappers/upper.py.
Additionally if you provide a `git.url` to a valid repository, the application will clone the repository to the local
file system during initialization and load scripts from there.


# CloudFoundry Deployment


You can download a Spring Cloud Stream Python App binary (e.g., with Rabbit or Kafka Binder) in the root directory of a
Python app, and push it using the {java-python-buildpack}[Java Python buildpack]. This build pack extends the
{python-buildpack}[Python buildpack] to support the deployment of a full Python app in the container. The Spring
Cloud Stream App will be started and willlaunch a local Python process
or run a packaged script using an embedded Jython ScriptEngine, depending on the configuration. For example. Suppose
you have a directory containing:

```
myapp.py
requirements.txt
python-local-processor-rabbit-1.2.1.BUILD-SNAPSHOT.jar
```

You can:

```
$ cf push -b  https://github.com/dturanski/java-python-buildpack
```

Or for use with Spring Cloud Data Flow Cloud Foundry Server, you can zip the directory and register the zip file as
processor. You must also specify the Java Python buildpack as a deployment property

```
$ zip ../myapp.zip -r *
```


# Python via Http

These applications provide a simple way to integrate with an external Python application exposed as an http service.
This will technically work with any http service. It is a specialized implementation of the
https://github.com/spring-cloud-stream-app-starters/httpclient[httpclient]
processor that provides support for local execution of a Python wrapper script via an embedded Jython ScriptEngine to
transform data in and out of the http server.

## Python Http Processor
include::spring-cloud-starter-stream-processor-python-http/README.adoc[]

## Jython Processor
include::spring-cloud-starter-stream-processor-python-jython/README.adoc[]

# Python Local Process

These applications install and run an external Python application in the local container.

## Python Local Processor
include::spring-cloud-starter-stream-processor-python-local/README.adoc[]

## Python Local Sink
include::spring-cloud-starter-stream-sink-python-local/README.adoc[]


## Prerequisites

These applications install and run an external Python application in the local container. These applications typically 
import https://pypi.python.org/pypi/springcloudstream[springcloudstream] to handle low level I/O. Simply provide a
single argument Function that returns a value. Both the argument and return value must be `str` types.

For example

```python
from springcloudstream.stream import Processor

def echo(data):
    return data


process = Processor()
process.start(echo)
```

The application requires that Python (2.7 or 3) is installed along with Java in the local container or server.

* Standalone - Install Python per instructions for your OS.
* CloudFoundry - Use the https://github.com/dturanski/java-python-buildpack[java-python-buildpack].
* Docker - Use one of the of the java-python images https://hub.docker.com/u/korekontrol/[here],

If the Python app is pulled from Git at runtime, the Java application will invoke `pip` to install any dependencies
listed in `requirements.txt`. If using the Java Python Buildpack, the buildpack will handle this.
In either case, include the line
```
springcloudstream>=1.0
```


[Java Python Buildpack] https://github.com/dturanski/java-python-buildpack
[Python buildpack] https://github.com/cloudfoundry/python-buildpack